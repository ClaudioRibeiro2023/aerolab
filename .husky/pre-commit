#!/bin/sh
set -e

# garante binÃ¡rios locais (lint-staged/prettier etc.)
export PATH="$(pwd)/node_modules/.bin:$PATH"

pnpm -s lint-staged

# Factory validate (opcional - define SKIP_FACTORY=1 para pular)
if [ -z "$SKIP_FACTORY" ]; then
  if command -v python >/dev/null 2>&1; then
    echo "ğŸ­ Running factory:validate..."
    python scripts/factory_validate.py || {
      echo "âŒ factory:validate failed. Use SKIP_FACTORY=1 to bypass."
      exit 1
    }
  fi
fi